<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>S&P 500 íŠ¸ë Œë“œ íŒ”ë¡œì‰ TOP 50</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap" rel="stylesheet">
<style>
:root{--bg0:#04070d;--bg1:#0a0f1a;--bg2:#111827;--bg3:#151d2e;--bg4:#1c2740;--bd:#1e2d45;
--t1:#e2e8f0;--t2:#94a3b8;--t3:#64748b;--g:#22c55e;--gd:rgba(34,197,94,.12);
--r:#ef4444;--rd:rgba(239,68,68,.12);--bl:#3b82f6;--bld:rgba(59,130,246,.12);
--y:#eab308;--yd:rgba(234,179,8,.12);--p:#a855f7;--cy:#06b6d4;--gold:#f59e0b}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Noto Sans KR',sans-serif;background:var(--bg0);color:var(--t1);overflow-x:hidden;min-height:100vh}
.m{font-family:'JetBrains Mono',monospace}
.container{max-width:1440px;margin:0 auto;padding:0 16px}

/* Header */
.hd{background:linear-gradient(180deg,rgba(17,24,39,.95),rgba(10,15,26,.98));border-bottom:1px solid var(--bd);padding:14px 16px;position:sticky;top:0;z-index:100;backdrop-filter:blur(16px)}
.hd-in{max-width:1440px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:10px}
.logo{display:flex;align-items:center;gap:10px}
.logo-i{width:34px;height:34px;background:linear-gradient(135deg,#3b82f6,#8b5cf6,#ec4899);border-radius:9px;display:flex;align-items:center;justify-content:center;font-size:16px;font-weight:900;color:#fff}
.logo h1{font-size:15px;font-weight:700;letter-spacing:-.3px}
.logo .sub{font-size:10px;color:var(--t3);margin-top:1px}
.upd{background:var(--bg3);border:1px solid var(--bd);border-radius:8px;padding:5px 10px;font-size:10px;color:var(--t2);display:flex;align-items:center;gap:5px}
.upd-dot{width:6px;height:6px;background:var(--g);border-radius:50%;animation:pulse 2s infinite}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.35}}

/* Section */
.section{margin-bottom:20px}
.section-title{font-size:14px;font-weight:700;margin-bottom:12px;display:flex;align-items:center;gap:8px}

/* Accordion */
.acc{border:1px solid var(--bd);border-radius:12px;background:var(--bg2);overflow:hidden}
.acc-hd{padding:14px 18px;cursor:pointer;display:flex;align-items:center;justify-content:space-between;user-select:none;transition:.2s}
.acc-hd:hover{background:var(--bg3)}
.acc-hd h2{font-size:14px;font-weight:700;display:flex;align-items:center;gap:7px}
.acc-arrow{transition:transform .3s;font-size:11px;color:var(--t3)}
.acc.open .acc-arrow{transform:rotate(180deg)}
.acc-body{max-height:0;overflow:hidden;transition:max-height .4s ease}
.acc.open .acc-body{max-height:4000px}
.acc-content{padding:0 18px 18px}
.strat-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:12px}
.strat-card{background:var(--bg3);border:1px solid var(--bd);border-radius:10px;padding:14px}
.strat-card h3{font-size:12px;font-weight:700;margin-bottom:8px;color:var(--bl)}
.strat-card p,.strat-card li{font-size:11px;color:var(--t2);line-height:1.7}
.strat-card ul{padding-left:14px}
.sc-tbl{width:100%;border-collapse:collapse;margin:6px 0}
.sc-tbl th{font-size:9px;text-transform:uppercase;letter-spacing:.5px;color:var(--t3);padding:5px 6px;text-align:left;border-bottom:1px solid var(--bd)}
.sc-tbl td{font-size:11px;padding:5px 6px;border-bottom:1px solid rgba(30,45,69,.4)}
.sc-tbl td:nth-child(2){font-family:'JetBrains Mono',monospace;font-weight:700;color:var(--bl);text-align:center}
.disc{background:rgba(239,68,68,.06);border:1px solid rgba(239,68,68,.15);border-radius:8px;padding:10px;font-size:10px;color:var(--t2);margin-top:10px}

/* Top 50 Hero Cards */
.hero-cards{display:flex;gap:10px;overflow-x:auto;padding-bottom:10px;scroll-snap-type:x mandatory;-webkit-overflow-scrolling:touch}
.hero-cards::-webkit-scrollbar{height:4px}.hero-cards::-webkit-scrollbar-thumb{background:var(--bd);border-radius:2px}
.hero{flex:0 0 200px;scroll-snap-align:start;background:linear-gradient(145deg,var(--bg3),var(--bg4));border:1px solid var(--bd);border-radius:14px;padding:16px;position:relative;overflow:hidden;cursor:pointer;transition:all .2s}
.hero:hover{border-color:var(--gold);transform:translateY(-2px);box-shadow:0 8px 24px rgba(245,158,11,.08)}
.hero-rank{position:absolute;top:10px;right:10px;font-family:'JetBrains Mono',monospace;font-size:28px;font-weight:900;color:rgba(245,158,11,.12);line-height:1}
.hero-tk{font-family:'JetBrains Mono',monospace;font-size:18px;font-weight:700;color:var(--gold)}
.hero-nm{font-size:10px;color:var(--t3);margin-top:2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.hero-fit{font-family:'JetBrains Mono',monospace;font-size:24px;font-weight:700;margin:10px 0 4px}
.hero-stats{display:flex;gap:8px;flex-wrap:wrap}
.hero-stat{font-size:10px;color:var(--t2)}
.hero-stat span{font-family:'JetBrains Mono',monospace;font-weight:600}
.hero-sig{display:inline-block;padding:3px 8px;border-radius:5px;font-size:9px;font-weight:700;letter-spacing:.3px;margin-top:6px}

/* Top 50 Table */
.t50-tbl{width:100%;border-collapse:separate;border-spacing:0 3px}
.t50-tbl thead th{font-size:9px;text-transform:uppercase;letter-spacing:.6px;color:var(--t3);padding:6px 8px;text-align:left;position:sticky;top:56px;background:var(--bg0);z-index:10}
.t50-row{cursor:pointer;transition:.15s}
.t50-row:hover td{background:var(--bg4)}
.t50-row td{background:var(--bg3);padding:8px;font-size:12px;border-top:1px solid var(--bd);border-bottom:1px solid var(--bd)}
.t50-row td:first-child{border-radius:8px 0 0 8px;border-left:1px solid var(--bd)}
.t50-row td:last-child{border-radius:0 8px 8px 0;border-right:1px solid var(--bd)}

/* Chart Section */
.chart-sec{background:var(--bg2);border:1px solid var(--bd);border-radius:12px;padding:16px}
.chart-tabs{display:flex;gap:3px;margin-bottom:10px;flex-wrap:wrap}
.chart-tab{background:var(--bg3);border:1px solid var(--bd);border-radius:6px;padding:5px 10px;font-size:10px;color:var(--t3);cursor:pointer;transition:.2s}
.chart-tab:hover{border-color:var(--t3)}
.chart-tab.active{background:var(--bld);border-color:var(--bl);color:var(--bl)}
.chart-wrap{position:relative;height:220px}

/* Overview */
.ov-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(130px,1fr));gap:10px;margin-bottom:14px}
.ov{background:var(--bg2);border:1px solid var(--bd);border-radius:10px;padding:12px;text-align:center;transition:.2s}
.ov:hover{border-color:var(--bl)}
.ov .lb{font-size:9px;color:var(--t3);text-transform:uppercase;letter-spacing:.4px;margin-bottom:3px}
.ov .vl{font-family:'JetBrains Mono',monospace;font-size:22px;font-weight:700}
.ov .sv{font-size:10px;color:var(--t2);margin-top:1px}

/* Sectors */
.sec-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:6px;margin-bottom:16px}
.sec{background:var(--bg2);border:1px solid var(--bd);border-radius:9px;padding:9px 12px;display:flex;align-items:center;justify-content:space-between;cursor:pointer;transition:.2s;position:relative;overflow:hidden}
.sec:hover{border-color:var(--bl);transform:translateY(-1px)}
.sec .fill{position:absolute;left:0;top:0;bottom:0;opacity:.08;border-radius:9px}
.sec .sn{font-size:11px;font-weight:500;position:relative;z-index:1}
.sec .ss{font-family:'JetBrains Mono',monospace;font-size:15px;font-weight:700;position:relative;z-index:1}
.sec .si{font-size:9px;color:var(--t3);position:relative;z-index:1}

/* Controls */
.ctrl{display:flex;flex-wrap:wrap;gap:8px;align-items:center;margin-bottom:12px}
.search{flex:1;min-width:180px;background:var(--bg2);border:1px solid var(--bd);border-radius:8px;padding:8px 12px;color:var(--t1);font-size:13px;font-family:'Noto Sans KR',sans-serif;outline:none;transition:.2s}
.search:focus{border-color:var(--bl)}.search::placeholder{color:var(--t3)}
.fg{display:flex;gap:3px;flex-wrap:wrap}
.fb{background:var(--bg2);border:1px solid var(--bd);border-radius:7px;padding:6px 11px;color:var(--t2);font-size:11px;font-weight:500;cursor:pointer;transition:.2s;white-space:nowrap;font-family:'Noto Sans KR',sans-serif}
.fb:hover{border-color:var(--t2)}.fb.on{background:var(--bld);border-color:var(--bl);color:var(--bl)}
.sel{background:var(--bg2);border:1px solid var(--bd);border-radius:7px;padding:6px 10px;color:var(--t1);font-size:11px;font-family:'Noto Sans KR',sans-serif;cursor:pointer;outline:none}
.cnt{font-size:11px;color:var(--t3)}

/* Full Table */
.tbl{width:100%;border-collapse:separate;border-spacing:0 3px}
.tbl thead th{font-size:9px;text-transform:uppercase;letter-spacing:.6px;color:var(--t3);padding:6px 8px;text-align:left;white-space:nowrap;position:sticky;top:56px;background:var(--bg0);z-index:10}
.row{cursor:pointer;transition:.15s}
.row:hover td{background:var(--bg4)}
.row td{background:var(--bg2);padding:8px;font-size:12px;border-top:1px solid var(--bd);border-bottom:1px solid var(--bd)}
.row td:first-child{border-radius:8px 0 0 8px;border-left:1px solid var(--bd)}
.row td:last-child{border-radius:0 8px 8px 0;border-right:1px solid var(--bd)}

/* Shared badge styles */
.tk{font-family:'JetBrains Mono',monospace;font-weight:700;font-size:13px;color:var(--bl)}
.tn{font-size:10px;color:var(--t3);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:120px}
.sb{display:inline-block;padding:3px 8px;border-radius:5px;font-size:10px;font-weight:700;letter-spacing:.3px;white-space:nowrap}
.sb-STRONG_BUY{background:var(--gd);color:var(--g);border:1px solid rgba(34,197,94,.25)}
.sb-BUY{background:var(--bld);color:var(--bl);border:1px solid rgba(59,130,246,.25)}
.sb-HOLD{background:var(--yd);color:var(--y);border:1px solid rgba(234,179,8,.25)}
.sb-SELL{background:var(--rd);color:var(--r);border:1px solid rgba(239,68,68,.25)}
.sc-bar{width:50px;height:4px;background:var(--bg0);border-radius:2px;overflow:hidden;display:inline-block;vertical-align:middle;margin-left:5px}
.sc-fill{height:100%;border-radius:2px}
.pos{color:var(--g)}.neg{color:var(--r)}
.trophy{color:var(--gold);font-size:10px;margin-right:3px}
.pz{display:inline-block;padding:2px 4px;border-radius:3px;font-size:9px;font-family:'JetBrains Mono',monospace;margin-right:1px;font-weight:600}
.pz-y{background:var(--gd);color:var(--g)}.pz-n{background:var(--bg0);color:var(--t3)}
.ew{display:inline-flex;align-items:center;gap:1px;padding:2px 5px;border-radius:3px;font-size:9px;font-weight:600;background:var(--rd);color:var(--r)}

/* Detail Overlay */
.overlay{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.75);z-index:200;backdrop-filter:blur(4px);overflow-y:auto;-webkit-overflow-scrolling:touch}
.overlay.show{display:block}
.dp{background:var(--bg1);border:1px solid var(--bd);border-radius:16px;width:94%;max-width:820px;margin:20px auto;padding:20px;position:relative}
.dp-close{position:absolute;top:12px;right:12px;background:var(--bg3);border:1px solid var(--bd);border-radius:7px;width:30px;height:30px;display:flex;align-items:center;justify-content:center;color:var(--t2);cursor:pointer;font-size:15px;transition:.2s;z-index:10}
.dp-close:hover{border-color:var(--r);color:var(--r)}
.dp-hd{display:flex;align-items:flex-start;gap:12px;margin-bottom:16px;padding-right:36px}
.dp-tk{font-family:'JetBrains Mono',monospace;font-size:24px;font-weight:700;color:var(--bl)}
.dp-nm{font-size:12px;color:var(--t2)}
.dp-sec-tag{font-size:9px;background:var(--bg3);padding:2px 7px;border-radius:4px;color:var(--t3);border:1px solid var(--bd);display:inline-block;margin-top:2px}
.dp-right{margin-left:auto;text-align:right}
.dp-right .big{font-family:'JetBrains Mono',monospace;font-size:36px;font-weight:700;line-height:1}
.dp-tv{background:var(--bg2);border:1px solid var(--bd);border-radius:10px;overflow:hidden;margin-bottom:14px}
.dp-charts{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:14px}
.dp-chart{background:var(--bg2);border:1px solid var(--bd);border-radius:10px;padding:12px}
.dp-chart h4{font-size:9px;text-transform:uppercase;letter-spacing:.6px;color:var(--t3);margin-bottom:8px}
.dp-chart-wrap{position:relative;height:170px}
.dp-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:14px}
.dc{background:var(--bg2);border:1px solid var(--bd);border-radius:10px;padding:12px}
.dc h4{font-size:9px;text-transform:uppercase;letter-spacing:.6px;color:var(--t3);margin-bottom:6px}
.dr{display:flex;justify-content:space-between;align-items:center;padding:2px 0;font-size:11px}
.dr .dl{color:var(--t2)}.dr .dv{font-family:'JetBrains Mono',monospace;font-weight:600}
.bt-sec{background:var(--bg2);border:1px solid var(--bd);border-radius:10px;padding:12px}
.bt-sec h4{font-size:9px;text-transform:uppercase;letter-spacing:.6px;color:var(--t3);margin-bottom:8px}
.bt-g{display:grid;grid-template-columns:repeat(auto-fit,minmax(85px,1fr));gap:6px}
.bt-s{text-align:center;padding:8px;background:var(--bg3);border-radius:7px}
.bt-s .bv{font-family:'JetBrains Mono',monospace;font-size:14px;font-weight:700}
.bt-s .blab{font-size:9px;color:var(--t3);margin-top:1px}

::-webkit-scrollbar{width:5px}::-webkit-scrollbar-track{background:var(--bg0)}::-webkit-scrollbar-thumb{background:var(--bd);border-radius:2px}

@media(max-width:768px){
  .ov-grid{grid-template-columns:repeat(2,1fr)}.sec-grid{grid-template-columns:repeat(2,1fr)}
  .ctrl{flex-direction:column}.search{width:100%}
  .dp{padding:14px;width:97%;margin:10px auto}.dp-charts,.dp-grid{grid-template-columns:1fr}
  .dp-tk{font-size:18px}.dp-right .big{font-size:28px}.dp-chart-wrap{height:140px}
  .strat-grid{grid-template-columns:1fr}.hm{display:none}.chart-wrap{height:170px}
  .hero{flex:0 0 170px;padding:12px}.hero-fit{font-size:20px}.hero-tk{font-size:15px}
  .t50-tbl .hm2{display:none}
}
</style>
</head>
<body>

<!-- Header -->
<header class="hd"><div class="hd-in">
  <div class="logo"><div class="logo-i">TF</div><div><h1>S&P 500 íŠ¸ë Œë“œ íŒ”ë¡œì‰</h1><div class="sub">5ë…„ ë°±í…ŒìŠ¤íŠ¸ ê¸°ë°˜ Â· ì „ëµ ì í•©ë„ ë­í‚¹</div></div></div>
  <div class="upd"><span class="upd-dot"></span><span id="ut">ë¡œë”©ì¤‘...</span></div>
</div></header>

<div class="container" style="margin-top:16px">

<!-- Strategy Accordion -->
<div class="section">
<div class="acc" id="stratAcc">
  <div class="acc-hd" onclick="this.parentElement.classList.toggle('open')">
    <h2>ğŸ“– ì „ëµ ì„¤ëª… â€” íŠ¸ë Œë“œ íŒ”ë¡œì‰ì´ë€?</h2><span class="acc-arrow">â–¼</span>
  </div>
  <div class="acc-body"><div class="acc-content">
    <div class="strat-grid">
      <div class="strat-card">
        <h3>ğŸ¯ í•µì‹¬ ì›ë¦¬</h3>
        <p>"ì¶”ì„¸ê°€ ì‹œì‘ë˜ë©´ ì˜¬ë¼íƒ€ê³ , ëë‚˜ë©´ ë‚´ë¦°ë‹¤." ì €ê°€ë§¤ìˆ˜ê°€ ì•„ë‹Œ <strong>ì´ë¯¸ ìƒìŠ¹ ì¤‘ì¸ ê°•í•œ ì¢…ëª©ì— í¸ìŠ¹</strong>í•˜ëŠ” ì „ëµì…ë‹ˆë‹¤.</p>
        <p style="margin-top:6px">100% ì ì¤‘ì€ ë¶ˆê°€ëŠ¥í•˜ì§€ë§Œ <strong>í° ìˆ˜ìµ ëª‡ ë²ˆì´ ì‘ì€ ì†ì‹¤ ì—¬ëŸ¬ ë²ˆì„ ì»¤ë²„</strong>í•©ë‹ˆë‹¤. ì†ì‹¤ì€ ì§§ê²Œ, ìˆ˜ìµì€ ê¸¸ê²Œ.</p>
      </div>
      <div class="strat-card">
        <h3>ğŸ“Š ë³µí•© íŠ¸ë Œë“œ ì ìˆ˜ (0~100)</h3>
        <table class="sc-tbl"><thead><tr><th>ì¡°ê±´</th><th>ë°°ì </th><th>ì˜ë¯¸</th></tr></thead><tbody>
          <tr><td>ê°€ê²© &gt; 200ì¼ ì´í‰ì„ </td><td>+15</td><td>ì¥ê¸° ìƒìŠ¹</td></tr>
          <tr><td>ê°€ê²© &gt; 50ì¼ ì´í‰ì„ </td><td>+10</td><td>ì¤‘ê¸° ìƒìŠ¹</td></tr>
          <tr><td>50ì¼ &gt; 200ì¼ (ê³¨ë“ í¬ë¡œìŠ¤)</td><td>+15</td><td>ì¶”ì„¸ ì „í™˜</td></tr>
          <tr><td>10ì¼ EMA &gt; 30ì¼ EMA</td><td>+10</td><td>ë‹¨ê¸° ëª¨ë©˜í…€</td></tr>
          <tr><td>MACD &gt; ì‹œê·¸ë„</td><td>+10</td><td>ë§¤ìˆ˜ ëª¨ë©˜í…€</td></tr>
          <tr><td>RSI &gt; 50</td><td>+10</td><td>ìƒìŠ¹ í˜</td></tr>
          <tr><td>ADX &gt; 25</td><td>+15</td><td>ê°•í•œ ì¶”ì„¸</td></tr>
          <tr><td>ADX &gt; 40 (ë³´ë„ˆìŠ¤)</td><td>+5</td><td>ë§¤ìš° ê°•í•œ</td></tr>
          <tr><td>Supertrend ìƒìŠ¹</td><td>+10</td><td>ì¢…í•© ìƒìŠ¹</td></tr>
        </tbody></table>
      </div>
      <div class="strat-card">
        <h3>ğŸ“¥ğŸ“¤ ë§¤ë§¤ ê·œì¹™</h3>
        <ul>
          <li><strong style="color:var(--g)">ì§„ì…:</strong> íŠ¸ë Œë“œ ì ìˆ˜ <strong>60ì  ì´ìƒ</strong></li>
          <li><strong style="color:var(--r)">í‡´ì¶œ:</strong> íŠ¸ë Œë“œ ì ìˆ˜ <strong>40ì  ì´í•˜</strong></li>
          <li><strong style="color:var(--y)">ê´€ë§:</strong> 40~60 ê¸°ì¡´ í¬ì§€ì…˜ ìœ ì§€</li>
        </ul>
        <h3 style="margin-top:10px">ğŸ’° ìµì ˆ ê°€ì´ë“œ</h3>
        <ul>
          <li><strong>ATR íŠ¸ë ˆì¼ë§ ìŠ¤í†±:</strong> ê³ ì -ATRÃ—2 í•˜ë½ ì‹œ ë§¤ë„</li>
          <li><strong>+10%/+20%/+30%:</strong> ëª©í‘œ ë‹¬ì„± ì‹œ ë¶€ë¶„ ìµì ˆ</li>
          <li><strong>EMA-10 ì´íƒˆ:</strong> ë‹¨ê¸° ì§€ì§€ì„  ë¶•ê´´ ê²½ê³ </li>
        </ul>
      </div>
      <div class="strat-card">
        <h3>ğŸ† ì „ëµ ì í•©ë„ ì ìˆ˜</h3>
        <p>5ë…„ ë°±í…ŒìŠ¤íŠ¸ ê¸°ë°˜ìœ¼ë¡œ ì´ ì „ëµê³¼ <strong>ê¶í•©ì´ ì¢‹ì€ ì¢…ëª©</strong>ì„ ì„ ë³„í•©ë‹ˆë‹¤.</p>
        <table class="sc-tbl"><thead><tr><th>ì§€í‘œ</th><th>ë¹„ì¤‘</th></tr></thead><tbody>
          <tr><td>ì´ˆê³¼ìˆ˜ìµ (ì „ëµ - ë‹¨ìˆœë³´ìœ )</td><td>30%</td></tr>
          <tr><td>ìˆ˜ìµ/ì†ì‹¤ ë¹„ìœ¨</td><td>20%</td></tr>
          <tr><td>ìŠ¹ë¥ </td><td>20%</td></tr>
          <tr><td>ì´ ìˆ˜ìµë¥ </td><td>20%</td></tr>
          <tr><td>ìµœëŒ€ ë‚™í­ (ì—­ìˆ˜)</td><td>10%</td></tr>
        </tbody></table>
        <div class="disc">
          <p>âš ï¸ êµìœ¡/ì°¸ê³  ëª©ì ì´ë©° íˆ¬ì ê¶Œìœ ê°€ ì•„ë‹™ë‹ˆë‹¤. ê³¼ê±° ìˆ˜ìµì´ ë¯¸ë˜ë¥¼ ë³´ì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ìŠ¬ë¦¬í”¼ì§€Â·ìˆ˜ìˆ˜ë£Œ ë¯¸ë°˜ì˜.</p>
        </div>
      </div>
    </div>
  </div></div>
</div>
</div>

<!-- TOP 50 Section -->
<div class="section" id="top50sec">
  <div class="section-title">ğŸ† TOP 50 â€” íŠ¸ë Œë“œ íŒ”ë¡œì‰ ìµœì  ì¢…ëª© (5ë…„ ê²€ì¦)</div>
  <div style="overflow-x:auto">
    <table class="t50-tbl">
      <thead><tr>
        <th>#</th><th>ì¢…ëª©</th><th>ì í•©ë„</th><th>5ë…„ ìˆ˜ìµ</th><th>ì´ˆê³¼ìˆ˜ìµ</th><th class="hm2">ìŠ¹ë¥ </th><th class="hm2">ìˆ˜ìµ/ì†ì‹¤</th><th>í˜„ì¬ ì‹ í˜¸</th><th>í˜„ì¬ ì ìˆ˜</th>
      </tr></thead>
      <tbody id="t50body"></tbody>
    </table>
  </div>
</div>

<!-- Overview + Sectors -->
<div class="section">
  <div class="ov-grid" id="ovGrid"></div>
  <div class="sec-grid" id="secGrid"></div>
</div>

<!-- Controls + Full Table -->
<div class="section">
  <div class="section-title">ğŸ” ì „ì²´ ì¢…ëª© (íŠ¸ë Œë“œ ì ìˆ˜ ìˆœ)</div>
  <div class="ctrl">
    <input type="text" class="search" id="si" placeholder="ğŸ” ì¢…ëª© ê²€ìƒ‰...">
    <div class="fg" id="sf">
      <button class="fb on" data-f="ALL">ì „ì²´</button>
      <button class="fb" data-f="STRONG_BUY">ê°•í•œë§¤ìˆ˜</button>
      <button class="fb" data-f="BUY">ë§¤ìˆ˜</button>
      <button class="fb" data-f="HOLD">ê´€ë§</button>
      <button class="fb" data-f="SELL">ë§¤ë„</button>
    </div>
    <select class="sel" id="ss">
      <option value="score_d">íŠ¸ë Œë“œ ì ìˆ˜ â†“</option>
      <option value="fitness_d">ì í•©ë„ â†“</option>
      <option value="ret_d">5ë…„ ìˆ˜ìµ â†“</option>
      <option value="excess_d">ì´ˆê³¼ìˆ˜ìµ â†“</option>
      <option value="wr_d">ìŠ¹ë¥  â†“</option>
    </select>
    <span class="cnt" id="cnt"></span>
  </div>
  <table class="tbl">
    <thead><tr>
      <th>#</th><th>ì¢…ëª©</th><th>ê°€ê²©</th><th>ì ìˆ˜</th><th>ì‹ í˜¸</th><th class="hm">ì í•©ë„</th><th class="hm">5ë…„ ìˆ˜ìµ</th><th class="hm">ìŠ¹ë¥ </th>
    </tr></thead>
    <tbody id="tb"></tbody>
  </table>
</div>
</div>

<!-- Detail Overlay -->
<div class="overlay" id="ol"><div class="dp" id="dp"></div></div>

<script>
let D=null,H=null,cf='ALL',cs='score_d',csf=null,sq='';
let eqCI=null,yrCI=null;

const SC=s=>s>=75?'var(--g)':s>=60?'var(--bl)':s>=40?'var(--y)':'var(--r)';
const SN={'STRONG_BUY':'ê°•í•œë§¤ìˆ˜','BUY':'ë§¤ìˆ˜','HOLD':'ê´€ë§','SELL':'ë§¤ë„'};
const FN=n=>n==null?'-':n.toLocaleString('en-US',{minimumFractionDigits:2,maximumFractionDigits:2});
const FC=s=>s>=70?'var(--g)':s>=50?'var(--bl)':s>=35?'var(--y)':'var(--r)';

async function init(){
  try{D=await(await fetch('trend_data.json')).json()}catch{document.getElementById('tb').innerHTML='<tr><td colspan="8" style="text-align:center;padding:40px;color:var(--t3)">trend_data.json ë¡œë“œ ì‹¤íŒ¨</td></tr>';return}
  try{H=await(await fetch('trend_history.json')).json()}catch{H=[]}
  render();
}

// â”€â”€ Top 50 â”€â”€
function renderTop50(){
  const top50=D.stocks.slice().sort((a,b)=>b.strategy_fitness-a.strategy_fitness).slice(0,50);
  document.getElementById('t50body').innerHTML=top50.map((s,i)=>{
    const bt=s.backtest,fc=FC(s.strategy_fitness);
    return `<tr class="t50-row" onclick="showD('${s.ticker}')">
      <td class="m" style="color:var(--gold);font-size:10px;font-weight:700">${i+1}</td>
      <td><div class="tk">ğŸ† ${s.ticker}</div><div class="tn">${s.name}</div></td>
      <td><span class="m" style="font-weight:700;font-size:14px;color:${fc}">${s.strategy_fitness}</span></td>
      <td class="m" style="font-weight:600"><span class="${bt.total_return>=0?'pos':'neg'}">${bt.total_return>=0?'+':''}${bt.total_return}%</span></td>
      <td class="m" style="font-weight:600"><span class="${bt.excess_return>=0?'pos':'neg'}">${bt.excess_return>=0?'+':''}${bt.excess_return}%</span></td>
      <td class="hm2 m" style="color:${bt.win_rate>=50?'var(--g)':'var(--r)'}">${bt.win_rate}%</td>
      <td class="hm2 m">${bt.win_loss_ratio}</td>
      <td><span class="sb sb-${s.signal}">${SN[s.signal]}</span></td>
      <td><span class="m" style="font-weight:700;color:${SC(s.trend_score)}">${s.trend_score}</span><span class="sc-bar"><span class="sc-fill" style="width:${s.trend_score}%;background:${SC(s.trend_score)}"></span></span></td>
    </tr>`}).join('');
}

// â”€â”€ Overview + Sectors â”€â”€
function renderOv(){
  const m=D.market_summary;
  const c=[
    {l:'ë¶„ì„ ì¢…ëª©',v:m.total_stocks,c:'var(--t1)'},
    {l:'í‰ê·  ì ìˆ˜',v:m.avg_score,c:SC(m.avg_score),s:`ì¤‘ì•™ê°’ ${m.median_score}`},
    {l:'ê°•í•œë§¤ìˆ˜',v:m.strong_buy_count,c:'var(--g)',s:`${(m.strong_buy_count/m.total_stocks*100).toFixed(0)}%`},
    {l:'ë§¤ìˆ˜',v:m.buy_count,c:'var(--bl)',s:`${(m.buy_count/m.total_stocks*100).toFixed(0)}%`},
    {l:'ê´€ë§',v:m.hold_count,c:'var(--y)',s:`${(m.hold_count/m.total_stocks*100).toFixed(0)}%`},
    {l:'ë§¤ë„',v:m.sell_count,c:'var(--r)',s:`${(m.sell_count/m.total_stocks*100).toFixed(0)}%`}
  ];
  document.getElementById('ovGrid').innerHTML=c.map(x=>`<div class="ov"><div class="lb">${x.l}</div><div class="vl m" style="color:${x.c}">${x.v}</div>${x.s?`<div class="sv">${x.s}</div>`:''}</div>`).join('');
}
function renderSec(){
  const ss=D.sector_summary;const sorted=Object.entries(ss).sort((a,b)=>b[1].avg_score-a[1].avg_score);
  document.getElementById('secGrid').innerHTML=sorted.map(([n,d])=>{const c=SC(d.avg_score);const a=csf===n;
    return `<div class="sec${a?' active':''}" onclick="csf=csf==='${n}'?null:'${n}';renderSec();renderTbl()" style="${a?`border-color:${c}`:''}"><div class="fill" style="width:${d.avg_score}%;background:${c}"></div><div><div class="sn">${n}</div><div class="si">${d.count}ì¢…ëª©</div></div><div class="ss" style="color:${c}">${d.avg_score}</div></div>`}).join('');
}

// â”€â”€ Full Table â”€â”€
function getFiltered(){
  let s=[...D.stocks];
  if(sq){const q=sq.toLowerCase();s=s.filter(x=>x.ticker.toLowerCase().includes(q)||x.name.toLowerCase().includes(q))}
  if(cf!=='ALL')s=s.filter(x=>x.signal===cf);
  if(csf)s=s.filter(x=>x.sector===csf);
  switch(cs){
    case'score_d':s.sort((a,b)=>b.trend_score-a.trend_score);break;
    case'fitness_d':s.sort((a,b)=>b.strategy_fitness-a.strategy_fitness);break;
    case'ret_d':s.sort((a,b)=>b.backtest.total_return-a.backtest.total_return);break;
    case'excess_d':s.sort((a,b)=>b.backtest.excess_return-a.backtest.excess_return);break;
    case'wr_d':s.sort((a,b)=>b.backtest.win_rate-a.backtest.win_rate);break;
  }
  return s;
}
function renderTbl(){
  const stocks=getFiltered();document.getElementById('cnt').textContent=`${stocks.length}ì¢…ëª©`;
  document.getElementById('tb').innerHTML=stocks.map((s,i)=>{
    const sc=SC(s.trend_score),bt=s.backtest,cc=s.change_pct>=0?'pos':'neg';
    const sch=s.score_change?`<span class="m" style="font-size:9px;padding:1px 3px;border-radius:3px;background:${s.score_change>0?'var(--gd)':'var(--rd)'};color:${s.score_change>0?'var(--g)':'var(--r)'}">${s.score_change>0?'+':''}${s.score_change}</span>`:'';
    return `<tr class="row" onclick="showD('${s.ticker}')">
      <td class="m" style="color:var(--t3);font-size:10px">${s.fitness_rank<=50?'<span class="trophy">ğŸ†</span>':''}${i+1}</td>
      <td><div class="tk">${s.ticker}</div><div class="tn">${s.name}</div></td>
      <td><div class="m" style="font-weight:600;font-size:12px">$${FN(s.price)}</div><div class="m ${cc}" style="font-size:10px">${s.change_pct>=0?'+':''}${s.change_pct}%</div></td>
      <td><span class="m" style="font-weight:700;font-size:14px;color:${sc}">${s.trend_score}</span><span class="sc-bar"><span class="sc-fill" style="width:${s.trend_score}%;background:${sc}"></span></span> ${sch}</td>
      <td><span class="sb sb-${s.signal}">${SN[s.signal]}</span></td>
      <td class="hm"><span class="m" style="font-weight:600;color:${FC(s.strategy_fitness)}">${s.strategy_fitness}</span></td>
      <td class="hm"><span class="m" style="font-weight:600"><span class="${bt.total_return>=0?'pos':'neg'}">${bt.total_return>=0?'+':''}${bt.total_return}%</span></span></td>
      <td class="hm"><span class="m" style="color:${bt.win_rate>=50?'var(--g)':'var(--r)'}">${bt.win_rate}%</span></td>
    </tr>`}).join('')||'<tr><td colspan="8" style="text-align:center;padding:40px;color:var(--t3)">ê²°ê³¼ ì—†ìŒ</td></tr>';
}

// â”€â”€ Detail Panel with TradingView â”€â”€
function showD(tk){
  const s=D.stocks.find(x=>x.ticker===tk);if(!s)return;
  const sc=SC(s.trend_score),fc=FC(s.strategy_fitness),pt=s.profit_taking,bt=s.backtest,ind=s.indicators;
  const hasEC=bt.equity_curve&&bt.equity_curve.length>0;
  const hasYR=bt.yearly_returns&&Object.keys(bt.yearly_returns).length>0;

  // Build exchange prefix for TradingView
  const tvSymbol=s.ticker.replace('-','.');

  let html=`<div class="dp-close" onclick="closeD()">âœ•</div>
  <div class="dp-hd"><div><div class="dp-tk">${s.ticker}</div><div class="dp-nm">${s.name}</div><span class="dp-sec-tag">${s.sector}</span></div>
  <div class="dp-right">
    <div style="display:flex;gap:10px;align-items:flex-end;justify-content:flex-end">
      <div style="text-align:right"><div style="font-size:9px;color:var(--t3)">ì í•©ë„</div><div class="big" style="color:${fc}">${s.strategy_fitness}</div></div>
      <div style="text-align:right"><div style="font-size:9px;color:var(--t3)">ì ìˆ˜</div><div class="big" style="color:${sc}">${s.trend_score}</div></div>
    </div>
    <span class="sb sb-${s.signal}" style="margin-top:4px;display:inline-block">${SN[s.signal]}${s.fitness_rank<=50?' ğŸ† TOP '+s.fitness_rank:''}</span>
  </div></div>`;

  // TradingView Chart
  html+=`<div class="dp-tv"><div id="tv-widget" style="height:350px"></div></div>`;

  // Charts row
  html+=`<div class="dp-charts">`;
  if(hasEC){html+=`<div class="dp-chart"><h4>ğŸ’¹ 5ë…„ ìˆ˜ìµê³¡ì„  (ì „ëµ vs ë‹¨ìˆœë³´ìœ )</h4><div class="dp-chart-wrap"><canvas id="eqCanvas"></canvas></div></div>`}
  if(hasYR){html+=`<div class="dp-chart"><h4>ğŸ“… ì—°ë„ë³„ ìˆ˜ìµë¥  ë¹„êµ</h4><div class="dp-chart-wrap"><canvas id="yrCanvas"></canvas></div></div>`}
  html+=`</div>`;

  // Backtest stats
  html+=`<div class="bt-sec"><h4>ğŸ“Š 5ë…„ ë°±í…ŒìŠ¤íŠ¸ Â· ${bt.total_trades}íšŒ ê±°ë˜</h4>
    <div class="bt-g">
      <div class="bt-s"><div class="bv" style="color:${bt.win_rate>=50?'var(--g)':'var(--r)'}">${bt.win_rate}%</div><div class="blab">ìŠ¹ë¥ </div></div>
      <div class="bt-s"><div class="bv">${bt.total_trades}</div><div class="blab">ì´ ê±°ë˜</div></div>
      <div class="bt-s"><div class="bv pos">+${bt.avg_winner}%</div><div class="blab">í‰ê·  ìˆ˜ìµ</div></div>
      <div class="bt-s"><div class="bv neg">${bt.avg_loser}%</div><div class="blab">í‰ê·  ì†ì‹¤</div></div>
      <div class="bt-s"><div class="bv" style="color:${bt.total_return>=0?'var(--g)':'var(--r)'}">${bt.total_return>=0?'+':''}${bt.total_return}%</div><div class="blab">ì „ëµ ìˆ˜ìµ</div></div>
      <div class="bt-s"><div class="bv" style="color:${bt.buy_hold_return>=0?'var(--g)':'var(--r)'}">${bt.buy_hold_return>=0?'+':''}${bt.buy_hold_return}%</div><div class="blab">ë‹¨ìˆœ ë³´ìœ </div></div>
      <div class="bt-s"><div class="bv" style="color:${bt.excess_return>=0?'var(--g)':'var(--r)'}">${bt.excess_return>=0?'+':''}${bt.excess_return}%</div><div class="blab">ì´ˆê³¼ ìˆ˜ìµ</div></div>
      <div class="bt-s"><div class="bv">${bt.win_loss_ratio}</div><div class="blab">ìˆ˜ìµ/ì†ì‹¤</div></div>
      <div class="bt-s"><div class="bv neg">${bt.max_drawdown}%</div><div class="blab">ìµœëŒ€ ë‚™í­</div></div>
      <div class="bt-s"><div class="bv">${bt.profit_factor}</div><div class="blab">ìˆ˜ìµíŒ©í„°</div></div>
    </div>
  </div>`;

  // Info grid
  html+=`<div class="dp-grid" style="margin-top:10px">
    <div class="dc"><h4>ğŸ”§ ê¸°ìˆ ì  ì§€í‘œ</h4>
      <div class="dr"><span class="dl">SMA 50 / 200</span><span class="dv">$${FN(ind.sma_50)} / $${FN(ind.sma_200)}</span></div>
      <div class="dr"><span class="dl">RSI (14)</span><span class="dv" style="color:${ind.rsi>70?'var(--r)':ind.rsi<30?'var(--g)':'var(--t1)'}">${ind.rsi}</span></div>
      <div class="dr"><span class="dl">ADX</span><span class="dv" style="color:${ind.adx>25?'var(--g)':'var(--t3)'}">${ind.adx}${ind.adx>40?' ğŸ”¥':ind.adx>25?' âœ“':''}</span></div>
      <div class="dr"><span class="dl">Supertrend</span><span class="dv" style="color:${ind.supertrend_dir==='UP'?'var(--g)':'var(--r)'}">${ind.supertrend_dir==='UP'?'â–² ìƒìŠ¹':'â–¼ í•˜ë½'}</span></div>
      <div class="dr"><span class="dl">ATR</span><span class="dv">$${FN(ind.atr)}</span></div>
      <div class="dr"><span class="dl">MACD</span><span class="dv">${ind.macd} / ${ind.macd_signal}</span></div>
    </div>
    <div class="dc"><h4>ğŸ’° ìµì ˆ ì‹ í˜¸</h4>
      <div class="dr"><span class="dl">ì§„ì…ê°€ (${pt.entry_date})</span><span class="dv">$${FN(pt.entry_price)}</span></div>
      <div class="dr"><span class="dl">ìˆ˜ìµë¥ </span><span class="dv ${pt.gain_since_signal>=0?'pos':'neg'}">${pt.gain_since_signal>=0?'+':''}${pt.gain_since_signal}% (${pt.days_in_trend}ì¼)</span></div>
      <div class="dr"><span class="dl">ATR ìŠ¤í†±</span><span class="dv">$${FN(pt.atr_trailing_stop)}</span></div>
      <div style="margin-top:5px;display:flex;gap:3px;flex-wrap:wrap">
        <span class="pz ${pt.reached_10?'pz-y':'pz-n'}">+10% ${pt.reached_10?'âœ“':''}</span>
        <span class="pz ${pt.reached_20?'pz-y':'pz-n'}">+20% ${pt.reached_20?'âœ“':''}</span>
        <span class="pz ${pt.reached_30?'pz-y':'pz-n'}">+30% ${pt.reached_30?'âœ“':''}</span>
      </div>
      <div style="margin-top:6px;padding:6px;background:var(--bg3);border-radius:5px;font-size:10px">
        <div class="dr"><span class="dl">EMA-10 ì´íƒˆ</span><span class="dv" style="color:${pt.ema10_exit_warning?'var(--r)':'var(--g)'}">${pt.ema10_exit_warning?'âš  ê²½ê³ ':'âœ“ ì•ˆì „'}</span></div>
        <div class="dr"><span class="dl">ì ìˆ˜ í•˜ë½</span><span class="dv" style="color:${pt.score_drop_warning?'var(--r)':'var(--g)'}">${pt.score_drop_warning?'âš  ê²½ê³ ':'âœ“ ì•ˆì „'}</span></div>
      </div>
    </div>
  </div>`;

  document.getElementById('dp').innerHTML=html;
  document.getElementById('ol').classList.add('show');
  document.body.style.overflow='hidden';

  // Load TradingView widget
  setTimeout(()=>{
    loadTV(tvSymbol);
    if(hasEC)renderEqChart(s);
    if(hasYR)renderYrChart(s);
  },100);
}

// TradingView Widget
function loadTV(symbol){
  const el=document.getElementById('tv-widget');if(!el)return;
  const h=window.innerWidth<=768?260:350;
  el.style.height=h+'px';
  const script=document.createElement('script');
  script.src='https://s3.tradingview.com/tv.js';
  script.onload=()=>{
    new TradingView.widget({
      autosize:true,container_id:'tv-widget',symbol:symbol,interval:'D',timezone:'America/New_York',
      theme:'dark',style:'1',locale:'kr',toolbar_bg:'#0a0f1a',
      enable_publishing:false,hide_side_toolbar:window.innerWidth<=768,
      allow_symbol_change:false,save_image:false,
      backgroundColor:'#0a0f1a',gridColor:'rgba(30,45,69,.4)',
      studies:['MASimple@tv-basicstudies','MASimple@tv-basicstudies'],
      studies_overrides:{'moving average.length':50,'moving average.color':'#3b82f6',
        'moving average #2.length':200,'moving average #2.color':'#eab308'}
    });
  };
  document.head.appendChild(script);
}

// Equity Curve Chart
function renderEqChart(s){
  const ec=s.backtest.equity_curve;if(!ec?.length)return;
  const ctx=document.getElementById('eqCanvas');if(!ctx)return;
  const lb=ec.map(e=>e.d.slice(2,7));
  const tm=s.backtest.trade_markers||[];
  const buyPts=new Array(ec.length).fill(null);
  const sellPts=new Array(ec.length).fill(null);
  tm.forEach(m=>{const idx=ec.findIndex(e=>e.d===m.date);if(idx>=0){if(m.type==='BUY')buyPts[idx]=ec[idx].s;else sellPts[idx]=ec[idx].s}});

  if(eqCI)eqCI.destroy();
  eqCI=new Chart(ctx,{type:'line',data:{labels:lb,datasets:[
    {label:'ì „ëµ',data:ec.map(e=>e.s),borderColor:'#3b82f6',backgroundColor:'rgba(59,130,246,.08)',fill:true,tension:.3,pointRadius:0,borderWidth:2},
    {label:'ë‹¨ìˆœë³´ìœ ',data:ec.map(e=>e.b),borderColor:'#64748b',borderDash:[4,4],tension:.3,pointRadius:0,borderWidth:1.5},
    {label:'â–² ë§¤ìˆ˜',data:buyPts,borderColor:'#22c55e',backgroundColor:'#22c55e',pointStyle:'triangle',pointRadius:6,showLine:false},
    {label:'â–¼ ë§¤ë„',data:sellPts,borderColor:'#ef4444',backgroundColor:'#ef4444',pointStyle:'triangle',rotation:180,pointRadius:6,showLine:false}
  ]},options:{responsive:true,maintainAspectRatio:false,interaction:{intersect:false,mode:'index'},
    plugins:{legend:{labels:{color:'#94a3b8',font:{size:8},usePointStyle:true}},
      tooltip:{callbacks:{label:c=>{if(c.dataset.label==='â–² ë§¤ìˆ˜'&&c.raw)return`ë§¤ìˆ˜ ${c.raw}`;if(c.dataset.label==='â–¼ ë§¤ë„'&&c.raw)return`ë§¤ë„ ${c.raw}`;return`${c.dataset.label}: ${c.raw}`}}}},
    scales:{x:{ticks:{color:'#64748b',font:{size:8},maxTicksLimit:8},grid:{display:false}},y:{ticks:{color:'#64748b',font:{size:8}},grid:{color:'rgba(30,45,69,.4)'}}}}});
}

// Yearly Returns Chart
function renderYrChart(s){
  const yr=s.backtest.yearly_returns;if(!yr)return;
  const ctx=document.getElementById('yrCanvas');if(!ctx)return;
  const years=Object.keys(yr).sort();
  const strat=years.map(y=>yr[y].strategy);
  const bh=years.map(y=>yr[y].buy_hold);

  if(yrCI)yrCI.destroy();
  yrCI=new Chart(ctx,{type:'bar',data:{labels:years,datasets:[
    {label:'ì „ëµ',data:strat,backgroundColor:strat.map(v=>v>=0?'rgba(59,130,246,.8)':'rgba(239,68,68,.8)'),borderRadius:4,barPercentage:.4,categoryPercentage:.7},
    {label:'ë‹¨ìˆœë³´ìœ ',data:bh,backgroundColor:bh.map(v=>v>=0?'rgba(148,163,184,.4)':'rgba(148,163,184,.3)'),borderRadius:4,barPercentage:.4,categoryPercentage:.7}
  ]},options:{responsive:true,maintainAspectRatio:false,
    plugins:{legend:{labels:{color:'#94a3b8',font:{size:8}}},
      tooltip:{callbacks:{label:c=>`${c.dataset.label}: ${c.raw>=0?'+':''}${c.raw}%`}}},
    scales:{x:{ticks:{color:'#94a3b8',font:{size:10}},grid:{display:false}},
      y:{ticks:{color:'#64748b',font:{size:8},callback:v=>v+'%'},grid:{color:'rgba(30,45,69,.4)'}}}}});
}

function closeD(){
  document.getElementById('ol').classList.remove('show');document.body.style.overflow='';
  if(eqCI){eqCI.destroy();eqCI=null}if(yrCI){yrCI.destroy();yrCI=null}
}

// â”€â”€ Events â”€â”€
document.getElementById('si').addEventListener('input',e=>{sq=e.target.value;renderTbl()});
document.getElementById('sf').addEventListener('click',e=>{if(e.target.classList.contains('fb')){
  document.querySelectorAll('#sf .fb').forEach(b=>b.classList.remove('on'));e.target.classList.add('on');cf=e.target.dataset.f;renderTbl()}});
document.getElementById('ss').addEventListener('change',e=>{cs=e.target.value;renderTbl()});
document.getElementById('ol').addEventListener('click',e=>{if(e.target===document.getElementById('ol'))closeD()});
document.addEventListener('keydown',e=>{if(e.key==='Escape')closeD()});
function render(){
  document.getElementById('ut').textContent=`ì—…ë°ì´íŠ¸: ${D.updated}`;
  renderTop50();renderOv();renderSec();renderTbl();
}
init();
</script>
</body>
</html>
