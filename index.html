<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>S&P 500 íŠ¸ë Œë“œ íŒ”ë¡œì‰ ëŒ€ì‹œë³´ë“œ</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap" rel="stylesheet">
<style>
:root{--bg0:#060a10;--bg1:#0a0e17;--bg2:#111827;--bg3:#151d2e;--bg4:#1c2740;--bd:#1e2d45;
--t1:#e2e8f0;--t2:#94a3b8;--t3:#64748b;--g:#22c55e;--gd:rgba(34,197,94,.15);
--r:#ef4444;--rd:rgba(239,68,68,.15);--bl:#3b82f6;--bld:rgba(59,130,246,.15);
--y:#eab308;--yd:rgba(234,179,8,.15);--p:#a855f7;--cy:#06b6d4}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Noto Sans KR',sans-serif;background:var(--bg1);color:var(--t1);overflow-x:hidden}
.m{font-family:'JetBrains Mono',monospace}
.container{max-width:1440px;margin:0 auto;padding:0 20px}

/* Header */
.hd{background:linear-gradient(180deg,#111827,var(--bg1));border-bottom:1px solid var(--bd);padding:16px 20px;position:sticky;top:0;z-index:100;backdrop-filter:blur(12px)}
.hd-in{max-width:1440px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:12px}
.logo{display:flex;align-items:center;gap:12px}
.logo-i{width:36px;height:36px;background:linear-gradient(135deg,#3b82f6,#8b5cf6,#ec4899);border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:18px;font-weight:900;color:#fff}
.logo h1{font-size:16px;font-weight:700;letter-spacing:-0.5px}
.logo .sub{font-size:11px;color:var(--t3)}
.upd{background:var(--bg3);border:1px solid var(--bd);border-radius:8px;padding:6px 12px;font-size:11px;color:var(--t2);display:flex;align-items:center;gap:6px}
.upd-dot{width:7px;height:7px;background:var(--g);border-radius:50%;animation:pulse 2s infinite}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.4}}

/* Accordion */
.acc{border:1px solid var(--bd);border-radius:12px;background:var(--bg3);margin-bottom:20px;overflow:hidden}
.acc-hd{padding:16px 20px;cursor:pointer;display:flex;align-items:center;justify-content:space-between;user-select:none;transition:background .2s}
.acc-hd:hover{background:var(--bg4)}
.acc-hd h2{font-size:15px;font-weight:700;display:flex;align-items:center;gap:8px}
.acc-arrow{transition:transform .3s;font-size:12px;color:var(--t3)}
.acc.open .acc-arrow{transform:rotate(180deg)}
.acc-body{max-height:0;overflow:hidden;transition:max-height .4s ease}
.acc.open .acc-body{max-height:3000px}
.acc-content{padding:0 20px 20px}

/* Strategy */
.strat-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:16px}
.strat-card{background:var(--bg2);border:1px solid var(--bd);border-radius:10px;padding:16px}
.strat-card h3{font-size:13px;font-weight:700;margin-bottom:10px;color:var(--bl);display:flex;align-items:center;gap:6px}
.strat-card p,.strat-card li{font-size:12px;color:var(--t2);line-height:1.7}
.strat-card ul{padding-left:16px}
.score-table{width:100%;border-collapse:collapse;margin:8px 0}
.score-table th{font-size:10px;text-transform:uppercase;letter-spacing:.5px;color:var(--t3);padding:6px 8px;text-align:left;border-bottom:1px solid var(--bd)}
.score-table td{font-size:12px;padding:6px 8px;border-bottom:1px solid rgba(30,45,69,.5)}
.score-table td:nth-child(2){font-family:'JetBrains Mono',monospace;font-weight:700;color:var(--bl);text-align:center}
.disclaimer{background:rgba(239,68,68,.08);border:1px solid rgba(239,68,68,.2);border-radius:8px;padding:12px;font-size:11px;color:var(--t2);margin-top:12px}

/* Market History Chart */
.chart-section{background:var(--bg3);border:1px solid var(--bd);border-radius:12px;padding:20px;margin-bottom:20px}
.chart-section h3{font-size:13px;font-weight:700;margin-bottom:14px;display:flex;align-items:center;gap:6px}
.chart-tabs{display:flex;gap:4px;margin-bottom:12px;flex-wrap:wrap}
.chart-tab{background:var(--bg2);border:1px solid var(--bd);border-radius:6px;padding:6px 12px;font-size:11px;color:var(--t3);cursor:pointer;transition:all .2s}
.chart-tab:hover{border-color:var(--t3)}
.chart-tab.active{background:var(--bld);border-color:var(--bl);color:var(--bl)}
.chart-wrap{position:relative;height:250px}

/* Overview Cards */
.ov-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:12px;margin-bottom:16px}
.ov{background:var(--bg3);border:1px solid var(--bd);border-radius:12px;padding:14px;text-align:center;transition:border-color .2s}
.ov:hover{border-color:var(--bl)}
.ov .lb{font-size:10px;color:var(--t3);text-transform:uppercase;letter-spacing:.5px;margin-bottom:4px}
.ov .vl{font-family:'JetBrains Mono',monospace;font-size:24px;font-weight:700}
.ov .sv{font-size:11px;color:var(--t2);margin-top:2px}

/* Sector Grid */
.sec-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:8px;margin-bottom:20px}
.sec{background:var(--bg3);border:1px solid var(--bd);border-radius:10px;padding:11px 14px;display:flex;align-items:center;justify-content:space-between;cursor:pointer;transition:all .2s;position:relative;overflow:hidden}
.sec:hover{border-color:var(--bl);transform:translateY(-1px)}
.sec .fill{position:absolute;left:0;top:0;bottom:0;opacity:.1;border-radius:10px}
.sec .sn{font-size:12px;font-weight:500;position:relative;z-index:1}
.sec .ss{font-family:'JetBrains Mono',monospace;font-size:16px;font-weight:700;position:relative;z-index:1}
.sec .si{font-size:10px;color:var(--t3);position:relative;z-index:1}

/* Controls */
.ctrl{display:flex;flex-wrap:wrap;gap:10px;align-items:center;margin-bottom:16px}
.search{flex:1;min-width:200px;background:var(--bg3);border:1px solid var(--bd);border-radius:10px;padding:10px 14px;color:var(--t1);font-size:14px;font-family:'Noto Sans KR',sans-serif;outline:none;transition:border-color .2s}
.search:focus{border-color:var(--bl)}
.search::placeholder{color:var(--t3)}
.fg{display:flex;gap:4px;flex-wrap:wrap}
.fb{background:var(--bg3);border:1px solid var(--bd);border-radius:8px;padding:8px 14px;color:var(--t2);font-size:12px;font-weight:500;cursor:pointer;transition:all .2s;white-space:nowrap;font-family:'Noto Sans KR',sans-serif}
.fb:hover{border-color:var(--t2)}
.fb.on{background:var(--bld);border-color:var(--bl);color:var(--bl)}
.sel{background:var(--bg3);border:1px solid var(--bd);border-radius:8px;padding:8px 12px;color:var(--t1);font-size:12px;font-family:'Noto Sans KR',sans-serif;cursor:pointer;outline:none}
.cnt{font-size:12px;color:var(--t3)}

/* Table */
.tbl{width:100%;border-collapse:separate;border-spacing:0 4px}
.tbl thead th{font-size:10px;text-transform:uppercase;letter-spacing:.7px;color:var(--t3);padding:8px 10px;text-align:left;white-space:nowrap;position:sticky;top:68px;background:var(--bg1);z-index:10}
.row{cursor:pointer;transition:all .15s}
.row:hover td{background:var(--bg4)}
.row td{background:var(--bg3);padding:10px;font-size:13px;border-top:1px solid var(--bd);border-bottom:1px solid var(--bd)}
.row td:first-child{border-radius:10px 0 0 10px;border-left:1px solid var(--bd)}
.row td:last-child{border-radius:0 10px 10px 0;border-right:1px solid var(--bd)}
.tk{font-family:'JetBrains Mono',monospace;font-weight:700;font-size:14px;color:var(--bl)}
.tn{font-size:11px;color:var(--t3);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:130px}
.sb{display:inline-block;padding:4px 10px;border-radius:6px;font-size:11px;font-weight:700;letter-spacing:.4px;text-transform:uppercase;white-space:nowrap}
.sb-STRONG_BUY{background:var(--gd);color:var(--g);border:1px solid rgba(34,197,94,.3)}
.sb-BUY{background:var(--bld);color:var(--bl);border:1px solid rgba(59,130,246,.3)}
.sb-HOLD{background:var(--yd);color:var(--y);border:1px solid rgba(234,179,8,.3)}
.sb-SELL{background:var(--rd);color:var(--r);border:1px solid rgba(239,68,68,.3)}
.sc-bar{width:55px;height:5px;background:var(--bg1);border-radius:3px;overflow:hidden;display:inline-block;vertical-align:middle;margin-left:6px}
.sc-fill{height:100%;border-radius:3px}
.pz{display:inline-block;padding:2px 5px;border-radius:4px;font-size:10px;font-family:'JetBrains Mono',monospace;margin-right:2px;font-weight:600}
.pz-y{background:var(--gd);color:var(--g)}.pz-n{background:var(--bg1);color:var(--t3)}
.ew{display:inline-flex;align-items:center;gap:2px;padding:2px 6px;border-radius:4px;font-size:10px;font-weight:600;background:var(--rd);color:var(--r);border:1px solid rgba(239,68,68,.3)}
.pos{color:var(--g)}.neg{color:var(--r)}

/* Detail Overlay */
.ov-lay{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.7);z-index:200;backdrop-filter:blur(4px)}
.ov-lay.show{display:flex;align-items:center;justify-content:center}
.dp{background:var(--bg2);border:1px solid var(--bd);border-radius:16px;width:92%;max-width:800px;max-height:88vh;overflow-y:auto;padding:24px;position:relative}
.dp-close{position:absolute;top:14px;right:14px;background:var(--bg3);border:1px solid var(--bd);border-radius:8px;width:32px;height:32px;display:flex;align-items:center;justify-content:center;color:var(--t2);cursor:pointer;font-size:16px;transition:all .2s;z-index:10}
.dp-close:hover{border-color:var(--r);color:var(--r)}
.dp-hd{display:flex;align-items:flex-start;gap:14px;margin-bottom:20px;padding-right:40px}
.dp-tk{font-family:'JetBrains Mono',monospace;font-size:26px;font-weight:700;color:var(--bl)}
.dp-nm{font-size:13px;color:var(--t2)}
.dp-sec{font-size:10px;background:var(--bg3);padding:3px 8px;border-radius:5px;color:var(--t3);border:1px solid var(--bd);display:inline-block;margin-top:3px}
.dp-sc{margin-left:auto;text-align:right}
.dp-sc .big{font-family:'JetBrains Mono',monospace;font-size:42px;font-weight:700;line-height:1}
.dp-charts{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:16px}
.dp-chart{background:var(--bg3);border:1px solid var(--bd);border-radius:10px;padding:14px}
.dp-chart h4{font-size:10px;text-transform:uppercase;letter-spacing:.7px;color:var(--t3);margin-bottom:10px}
.dp-chart-wrap{position:relative;height:180px}
.dp-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:16px}
.dc{background:var(--bg3);border:1px solid var(--bd);border-radius:10px;padding:14px}
.dc h4{font-size:10px;text-transform:uppercase;letter-spacing:.7px;color:var(--t3);margin-bottom:8px}
.dr{display:flex;justify-content:space-between;align-items:center;padding:3px 0;font-size:12px}
.dr .dl{color:var(--t2)}.dr .dv{font-family:'JetBrains Mono',monospace;font-weight:600}
.bt-sec{background:var(--bg3);border:1px solid var(--bd);border-radius:10px;padding:14px}
.bt-sec h4{font-size:10px;text-transform:uppercase;letter-spacing:.7px;color:var(--t3);margin-bottom:10px}
.bt-g{display:grid;grid-template-columns:repeat(auto-fit,minmax(100px,1fr));gap:8px}
.bt-s{text-align:center;padding:10px;background:var(--bg1);border-radius:8px}
.bt-s .bv{font-family:'JetBrains Mono',monospace;font-size:16px;font-weight:700}
.bt-s .bl{font-size:10px;color:var(--t3);margin-top:2px}

::-webkit-scrollbar{width:6px}::-webkit-scrollbar-track{background:var(--bg1)}::-webkit-scrollbar-thumb{background:var(--bd);border-radius:3px}

@media(max-width:768px){
  .ov-grid{grid-template-columns:repeat(2,1fr)}.sec-grid{grid-template-columns:repeat(2,1fr)}
  .ctrl{flex-direction:column}.search{width:100%}.dp{padding:16px;width:96%}
  .dp-charts,.dp-grid{grid-template-columns:1fr}.dp-tk{font-size:20px}.dp-sc .big{font-size:32px}
  .dp-chart-wrap{height:150px}.strat-grid{grid-template-columns:1fr}
  .hm{display:none}.chart-wrap{height:180px}
}
</style>
</head>
<body>

<header class="hd"><div class="hd-in">
  <div class="logo"><div class="logo-i">TF</div><div><h1>S&P 500 íŠ¸ë Œë“œ íŒ”ë¡œì‰</h1><div class="sub">Trend Following Dashboard v2 Â· 500ì¢…ëª© ë¶„ì„</div></div></div>
  <div class="upd"><span class="upd-dot"></span><span id="ut">ë¡œë”©ì¤‘...</span></div>
</div></header>

<div class="container" style="margin-top:20px">

<!-- Strategy Accordion -->
<div class="acc" id="stratAcc">
  <div class="acc-hd" onclick="this.parentElement.classList.toggle('open')">
    <h2>ğŸ“– ì „ëµ ì„¤ëª… â€” íŠ¸ë Œë“œ íŒ”ë¡œì‰ì´ë€?</h2>
    <span class="acc-arrow">â–¼</span>
  </div>
  <div class="acc-body"><div class="acc-content">
    <div class="strat-grid">
      <div class="strat-card">
        <h3>ğŸ¯ í•µì‹¬ ì›ë¦¬</h3>
        <p>"ì¶”ì„¸ê°€ ì‹œì‘ë˜ë©´ ì˜¬ë¼íƒ€ê³ , ëë‚˜ë©´ ë‚´ë¦°ë‹¤"ëŠ” ë‹¨ìˆœí•œ ì›ë¦¬ì…ë‹ˆë‹¤. ì›Œë Œ ë²„í•ì²˜ëŸ¼ ì €ê°€ì— ì‚¬ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, <strong>ì´ë¯¸ ìƒìŠ¹ ì¤‘ì¸ ê°•í•œ ì¢…ëª©ì— í¸ìŠ¹</strong>í•˜ëŠ” ì „ëµì…ë‹ˆë‹¤.</p>
        <p style="margin-top:8px">100% ì ì¤‘ì€ ë¶ˆê°€ëŠ¥í•˜ì§€ë§Œ, <strong>í° ìˆ˜ìµ ëª‡ ë²ˆì´ ì‘ì€ ì†ì‹¤ ì—¬ëŸ¬ ë²ˆì„ ì»¤ë²„</strong>í•©ë‹ˆë‹¤. í•µì‹¬ì€ ì†ì‹¤ì€ ì§§ê²Œ, ìˆ˜ìµì€ ê¸¸ê²Œ ê°€ì ¸ê°€ëŠ” ê²ƒì…ë‹ˆë‹¤.</p>
      </div>
      <div class="strat-card">
        <h3>ğŸ“Š ë³µí•© íŠ¸ë Œë“œ ì ìˆ˜ (0~100ì )</h3>
        <table class="score-table">
          <thead><tr><th>ì¡°ê±´</th><th>ë°°ì </th><th>ì˜ë¯¸</th></tr></thead>
          <tbody>
            <tr><td>ê°€ê²© &gt; 200ì¼ ì´í‰ì„ </td><td>+15</td><td>ì¥ê¸° ìƒìŠ¹ ì¶”ì„¸</td></tr>
            <tr><td>ê°€ê²© &gt; 50ì¼ ì´í‰ì„ </td><td>+10</td><td>ì¤‘ê¸° ìƒìŠ¹ ì¶”ì„¸</td></tr>
            <tr><td>50ì¼ &gt; 200ì¼ (ê³¨ë“ í¬ë¡œìŠ¤)</td><td>+15</td><td>ì¶”ì„¸ ì „í™˜ í™•ì¸</td></tr>
            <tr><td>10ì¼ EMA &gt; 30ì¼ EMA</td><td>+10</td><td>ë‹¨ê¸° ëª¨ë©˜í…€</td></tr>
            <tr><td>MACD &gt; ì‹œê·¸ë„</td><td>+10</td><td>ë§¤ìˆ˜ ëª¨ë©˜í…€</td></tr>
            <tr><td>RSI &gt; 50</td><td>+10</td><td>ìƒìŠ¹ í˜ ìœ ì§€</td></tr>
            <tr><td>ADX &gt; 25</td><td>+15</td><td>ì¶”ì„¸ ê°•ë„ ê°•í•¨</td></tr>
            <tr><td>ADX &gt; 40 (ë³´ë„ˆìŠ¤)</td><td>+5</td><td>ë§¤ìš° ê°•í•œ ì¶”ì„¸</td></tr>
            <tr><td>Supertrend ìƒìŠ¹</td><td>+10</td><td>ì¢…í•© ì¶”ì„¸ ìƒìŠ¹</td></tr>
          </tbody>
        </table>
      </div>
      <div class="strat-card">
        <h3>ğŸ“¥ğŸ“¤ ë§¤ë§¤ ê·œì¹™</h3>
        <ul>
          <li><strong style="color:var(--g)">ì§„ì… (ë§¤ìˆ˜):</strong> íŠ¸ë Œë“œ ì ìˆ˜ <strong>60ì  ì´ìƒ</strong>ì¼ ë•Œ ì§„ì…</li>
          <li><strong style="color:var(--r)">í‡´ì¶œ (ë§¤ë„):</strong> íŠ¸ë Œë“œ ì ìˆ˜ <strong>40ì  ì´í•˜</strong>ë¡œ í•˜ë½ ì‹œ í‡´ì¶œ</li>
          <li><strong style="color:var(--y)">ê´€ë§:</strong> 40~60ì  êµ¬ê°„ì—ì„œëŠ” ê¸°ì¡´ í¬ì§€ì…˜ ìœ ì§€</li>
        </ul>
        <h3 style="margin-top:14px">ğŸ’° ìµì ˆ ê°€ì´ë“œ</h3>
        <ul>
          <li><strong>ATR íŠ¸ë ˆì¼ë§ ìŠ¤í†±:</strong> ìµœê·¼ ê³ ì ì—ì„œ ATRÃ—2 í•˜ë½ ì‹œ ë§¤ë„ (ë³€ë™ì„± ìë™ ì ì‘)</li>
          <li><strong>+10%/+20%/+30% êµ¬ê°„:</strong> ëª©í‘œ ìˆ˜ìµ ë‹¬ì„± ì‹œ ë¶€ë¶„ ìµì ˆ ê³ ë ¤</li>
          <li><strong>EMA-10 ì´íƒˆ:</strong> ë‹¨ê¸° ì§€ì§€ì„  ë¶•ê´´ â†’ ì¡°ê¸° ê²½ê³ </li>
          <li><strong>ì ìˆ˜ 40 ì´í•˜:</strong> íŠ¸ë Œë“œ ì´íƒˆ í™•ì¸ â†’ ìµœì¢… ë§¤ë„</li>
        </ul>
      </div>
      <div class="strat-card">
        <h3>âš ï¸ ì£¼ì˜ì‚¬í•­</h3>
        <div class="disclaimer">
          <p>â€¢ ë³¸ ëŒ€ì‹œë³´ë“œëŠ” <strong>êµìœ¡ ë° ì°¸ê³  ëª©ì </strong>ì´ë©° íˆ¬ì ê¶Œìœ ê°€ ì•„ë‹™ë‹ˆë‹¤</p>
          <p>â€¢ ê³¼ê±° ë°±í…ŒìŠ¤íŠ¸ ê²°ê³¼ê°€ ë¯¸ë˜ ìˆ˜ìµì„ ë³´ì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤</p>
          <p>â€¢ ìŠ¬ë¦¬í”¼ì§€, ìˆ˜ìˆ˜ë£Œê°€ ë¯¸ë°˜ì˜ë˜ì–´ ì‹¤ì œ ìˆ˜ìµë¥ ì€ ë‹¤ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤</p>
          <p>â€¢ ê°œë³„ ì¢…ëª©ì— ëŒ€í•œ ì¶”ê°€ ë¦¬ì„œì¹˜ê°€ ë°˜ë“œì‹œ í•„ìš”í•©ë‹ˆë‹¤</p>
          <p>â€¢ ë¶„ì‚° íˆ¬ìì™€ ë¦¬ìŠ¤í¬ ê´€ë¦¬ë¥¼ í•­ìƒ ìš°ì„ í•˜ì„¸ìš”</p>
        </div>
      </div>
    </div>
  </div></div>
</div>

<!-- Market History Chart -->
<div class="chart-section" id="historySection">
  <h3>ğŸ“ˆ ì‹œì¥ íŠ¸ë Œë“œ ì¶”ì´</h3>
  <div class="chart-tabs" id="histTabs">
    <div class="chart-tab active" data-chart="score">í‰ê·  ì ìˆ˜</div>
    <div class="chart-tab" data-chart="signals">ì‹ í˜¸ ë¹„ìœ¨</div>
    <div class="chart-tab" data-chart="sectors">ì„¹í„° ë¡œí…Œì´ì…˜</div>
  </div>
  <div class="chart-wrap"><canvas id="histChart"></canvas></div>
</div>

<!-- Overview -->
<div class="ov-grid" id="ovGrid"></div>
<div class="sec-grid" id="secGrid"></div>

<!-- Controls -->
<div class="ctrl">
  <input type="text" class="search" id="si" placeholder="ğŸ” ì¢…ëª© ê²€ìƒ‰ (í‹°ì»¤ ë˜ëŠ” ì´ë¦„)...">
  <div class="fg" id="sf">
    <button class="fb on" data-f="ALL">ì „ì²´</button>
    <button class="fb" data-f="STRONG_BUY">ğŸŸ¢ ê°•í•œë§¤ìˆ˜</button>
    <button class="fb" data-f="BUY">ğŸ”µ ë§¤ìˆ˜</button>
    <button class="fb" data-f="HOLD">ğŸŸ¡ ê´€ë§</button>
    <button class="fb" data-f="SELL">ğŸ”´ ë§¤ë„</button>
  </div>
  <select class="sel" id="ss">
    <option value="score_desc">íŠ¸ë Œë“œ ì ìˆ˜ â†“</option>
    <option value="score_asc">íŠ¸ë Œë“œ ì ìˆ˜ â†‘</option>
    <option value="gain_desc">ìˆ˜ìµë¥  â†“</option>
    <option value="winrate_desc">ìŠ¹ë¥  â†“</option>
    <option value="change_desc">ë³€ë™í­ â†“</option>
  </select>
  <span class="cnt" id="cnt"></span>
</div>

<!-- Table -->
<table class="tbl">
  <thead><tr>
    <th>#</th><th>ì¢…ëª©</th><th>ê°€ê²©</th><th>íŠ¸ë Œë“œ ì ìˆ˜</th><th>ì‹ í˜¸</th>
    <th>ìˆ˜ìµ</th><th class="hm">ìµì ˆ</th><th class="hm">EXIT</th><th class="hm">ìŠ¹ë¥ </th>
  </tr></thead>
  <tbody id="tb"></tbody>
</table>
</div>

<!-- Detail Overlay -->
<div class="ov-lay" id="ol"><div class="dp" id="dp"></div></div>

<script>
let D=null,H=null,cf='ALL',cs='score_desc',csf=null,sq='';
let histChartInstance=null,priceChartInstance=null,eqChartInstance=null;

const SC=s=>s>=75?'var(--g)':s>=60?'var(--bl)':s>=40?'var(--y)':'var(--r)';
const SN={'STRONG_BUY':'ê°•í•œë§¤ìˆ˜','BUY':'ë§¤ìˆ˜','HOLD':'ê´€ë§','SELL':'ë§¤ë„'};
const FN=n=>n==null?'-':n.toLocaleString('en-US',{minimumFractionDigits:2,maximumFractionDigits:2});

async function init(){
  try{D=await(await fetch('trend_data.json')).json()}catch(e){document.getElementById('tb').innerHTML='<tr><td colspan="9" style="text-align:center;padding:40px;color:var(--t3)">trend_data.json ë¡œë“œ ì‹¤íŒ¨</td></tr>';return}
  try{H=await(await fetch('trend_history.json')).json()}catch(e){H=[]}
  render();
}

// â”€â”€ Market History Charts â”€â”€
function renderHistChart(type){
  if(histChartInstance){histChartInstance.destroy();histChartInstance=null}
  if(!H||!H.length)return;
  const ctx=document.getElementById('histChart').getContext('2d');
  const labels=H.map(h=>h.date.slice(5));
  let config;

  if(type==='score'){
    config={type:'line',data:{labels,datasets:[
      {label:'í‰ê·  ì ìˆ˜',data:H.map(h=>h.avg_score),borderColor:'#3b82f6',backgroundColor:'rgba(59,130,246,.1)',fill:true,tension:.3,pointRadius:2},
      {label:'ì¤‘ì•™ê°’',data:H.map(h=>h.median_score),borderColor:'#a855f7',borderDash:[4,4],tension:.3,pointRadius:0}
    ]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{labels:{color:'#94a3b8',font:{size:11}}}},scales:{x:{ticks:{color:'#64748b',font:{size:10}},grid:{color:'rgba(30,45,69,.5)'}},y:{min:30,max:80,ticks:{color:'#64748b'},grid:{color:'rgba(30,45,69,.5)'}}}}};
  } else if(type==='signals'){
    config={type:'bar',data:{labels,datasets:[
      {label:'ê°•í•œë§¤ìˆ˜',data:H.map(h=>h.strong_buy),backgroundColor:'rgba(34,197,94,.7)',stack:'s'},
      {label:'ë§¤ìˆ˜',data:H.map(h=>h.buy),backgroundColor:'rgba(59,130,246,.7)',stack:'s'},
      {label:'ê´€ë§',data:H.map(h=>h.hold),backgroundColor:'rgba(234,179,8,.7)',stack:'s'},
      {label:'ë§¤ë„',data:H.map(h=>h.sell),backgroundColor:'rgba(239,68,68,.7)',stack:'s'}
    ]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{labels:{color:'#94a3b8',font:{size:10}}}},scales:{x:{stacked:true,ticks:{color:'#64748b',font:{size:10}},grid:{display:false}},y:{stacked:true,ticks:{color:'#64748b'},grid:{color:'rgba(30,45,69,.5)'}}}}};
  } else {
    const secs=Object.keys(H[0]?.sectors||{}).slice(0,6);
    const colors=['#3b82f6','#22c55e','#eab308','#ef4444','#a855f7','#06b6d4'];
    config={type:'line',data:{labels,datasets:secs.map((s,i)=>({label:s,data:H.map(h=>(h.sectors||{})[s]||0),borderColor:colors[i%6],tension:.3,pointRadius:0,borderWidth:2}))},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{labels:{color:'#94a3b8',font:{size:9}}}},scales:{x:{ticks:{color:'#64748b',font:{size:10}},grid:{display:false}},y:{ticks:{color:'#64748b'},grid:{color:'rgba(30,45,69,.5)'}}}}};
  }
  histChartInstance=new Chart(ctx,config);
}

// â”€â”€ Overview â”€â”€
function renderOv(){
  const m=D.market_summary;
  const c=[
    {l:'ë¶„ì„ ì¢…ëª©',v:m.total_stocks,c:'var(--t1)'},
    {l:'í‰ê·  ì ìˆ˜',v:m.avg_score,c:SC(m.avg_score),s:`ì¤‘ì•™ê°’ ${m.median_score}`},
    {l:'ğŸŸ¢ ê°•í•œë§¤ìˆ˜',v:m.strong_buy_count,c:'var(--g)',s:`${(m.strong_buy_count/m.total_stocks*100).toFixed(1)}%`},
    {l:'ğŸ”µ ë§¤ìˆ˜',v:m.buy_count,c:'var(--bl)',s:`${(m.buy_count/m.total_stocks*100).toFixed(1)}%`},
    {l:'ğŸŸ¡ ê´€ë§',v:m.hold_count,c:'var(--y)',s:`${(m.hold_count/m.total_stocks*100).toFixed(1)}%`},
    {l:'ğŸ”´ ë§¤ë„',v:m.sell_count,c:'var(--r)',s:`${(m.sell_count/m.total_stocks*100).toFixed(1)}%`}
  ];
  document.getElementById('ovGrid').innerHTML=c.map(x=>`<div class="ov"><div class="lb">${x.l}</div><div class="vl m" style="color:${x.c}">${x.v}</div>${x.s?`<div class="sv">${x.s}</div>`:''}</div>`).join('');
}

function renderSec(){
  const ss=D.sector_summary;const sorted=Object.entries(ss).sort((a,b)=>b[1].avg_score-a[1].avg_score);
  document.getElementById('secGrid').innerHTML=sorted.map(([n,d])=>{const c=SC(d.avg_score);const a=csf===n;
    return `<div class="sec${a?' active':''}" onclick="csf=csf==='${n}'?null:'${n}';renderSec();renderTbl()" style="${a?`border-color:${c}`:''}"><div class="fill" style="width:${d.avg_score}%;background:${c}"></div><div><div class="sn">${n}</div><div class="si">${d.count}ì¢…ëª© Â· ë§¤ìˆ˜ ${d.strong_buy+d.buy}</div></div><div class="ss" style="color:${c}">${d.avg_score}</div></div>`}).join('');
}

// â”€â”€ Table â”€â”€
function getFiltered(){
  let s=[...D.stocks];
  if(sq){const q=sq.toLowerCase();s=s.filter(x=>x.ticker.toLowerCase().includes(q)||x.name.toLowerCase().includes(q))}
  if(cf!=='ALL')s=s.filter(x=>x.signal===cf);
  if(csf)s=s.filter(x=>x.sector===csf);
  switch(cs){
    case'score_desc':s.sort((a,b)=>b.trend_score-a.trend_score);break;
    case'score_asc':s.sort((a,b)=>a.trend_score-b.trend_score);break;
    case'gain_desc':s.sort((a,b)=>b.profit_taking.gain_since_signal-a.profit_taking.gain_since_signal);break;
    case'winrate_desc':s.sort((a,b)=>b.backtest.win_rate-a.backtest.win_rate);break;
    case'change_desc':s.sort((a,b)=>Math.abs(b.change_pct)-Math.abs(a.change_pct));break;
  }
  return s;
}

function renderTbl(){
  const stocks=getFiltered();document.getElementById('cnt').textContent=`${stocks.length}ì¢…ëª©`;
  document.getElementById('tb').innerHTML=stocks.map((s,i)=>{
    const sc=SC(s.trend_score),pt=s.profit_taking,bt=s.backtest,gc=pt.gain_since_signal>=0?'pos':'neg',cc=s.change_pct>=0?'pos':'neg';
    const sch=s.score_change?`<span class="m" style="font-size:10px;padding:2px 4px;border-radius:3px;background:${s.score_change>0?'var(--gd)':'var(--rd)'};color:${s.score_change>0?'var(--g)':'var(--r)'}">${s.score_change>0?'+':''}${s.score_change}</span>`:'';
    const ew=[];if(pt.ema10_exit_warning)ew.push('EMAâ†“');if(pt.score_drop_warning)ew.push('ì ìˆ˜â†“');
    const ewh=ew.length?ew.map(w=>`<span class="ew">âš ${w}</span>`).join(' '):'<span style="color:var(--t3);font-size:10px">â€”</span>';
    return `<tr class="row" onclick="showD('${s.ticker}')">
      <td class="m" style="color:var(--t3);font-size:11px">${i+1}</td>
      <td><div class="tk">${s.ticker}</div><div class="tn">${s.name}</div></td>
      <td><div class="m" style="font-weight:600">$${FN(s.price)}</div><div class="m ${cc}" style="font-size:11px">${s.change_pct>=0?'+':''}${s.change_pct}%</div></td>
      <td><span class="m" style="font-weight:700;font-size:15px;color:${sc}">${s.trend_score}</span><span class="sc-bar"><span class="sc-fill" style="width:${s.trend_score}%;background:${sc}"></span></span> ${sch}</td>
      <td><span class="sb sb-${s.signal}">${SN[s.signal]}</span></td>
      <td><span class="m ${gc}" style="font-weight:600;font-size:13px">${pt.gain_since_signal>=0?'+':''}${pt.gain_since_signal}%</span><div style="font-size:10px;color:var(--t3)">${pt.days_in_trend}ì¼</div></td>
      <td class="hm"><span class="pz ${pt.reached_10?'pz-y':'pz-n'}">10%</span><span class="pz ${pt.reached_20?'pz-y':'pz-n'}">20%</span><span class="pz ${pt.reached_30?'pz-y':'pz-n'}">30%</span></td>
      <td class="hm">${ewh}</td>
      <td class="hm"><span class="m" style="font-weight:600;color:${bt.win_rate>=50?'var(--g)':'var(--r)'}">${bt.win_rate}%</span></td>
    </tr>`}).join('')||'<tr><td colspan="9" style="text-align:center;padding:40px;color:var(--t3)">ê²°ê³¼ ì—†ìŒ</td></tr>';
}

// â”€â”€ Detail Panel â”€â”€
function showD(tk){
  const s=D.stocks.find(x=>x.ticker===tk);if(!s)return;
  const sc=SC(s.trend_score),pt=s.profit_taking,bt=s.backtest,ind=s.indicators;
  const hasPH=!!s.price_history;const hasEC=bt.equity_curve&&bt.equity_curve.length>0;
  const hasTM=bt.trade_markers&&bt.trade_markers.length>0;

  let html=`<div class="dp-close" onclick="closeD()">âœ•</div>
  <div class="dp-hd"><div><div class="dp-tk">${s.ticker}</div><div class="dp-nm">${s.name}</div><span class="dp-sec">${s.sector}</span></div>
  <div class="dp-sc"><span class="sb sb-${s.signal}" style="font-size:12px;padding:5px 12px">${SN[s.signal]}</span><div class="big" style="color:${sc};margin-top:4px">${s.trend_score}</div></div></div>`;

  // Charts section
  html+=`<div class="dp-charts">`;
  if(hasPH){
    html+=`<div class="dp-chart"><h4>ğŸ“ˆ 60ì¼ ê°€ê²©ì°¨íŠ¸ + ì‹ í˜¸</h4><div class="dp-chart-wrap"><canvas id="priceCanvas"></canvas></div></div>`;
  }
  if(hasEC){
    html+=`<div class="dp-chart"><h4>ğŸ’¹ ìˆ˜ìµê³¡ì„  (ì „ëµ vs ë‹¨ìˆœë³´ìœ )</h4><div class="dp-chart-wrap"><canvas id="eqCanvas"></canvas></div></div>`;
  }
  html+=`</div>`;

  // Info grid
  html+=`<div class="dp-grid">
    <div class="dc"><h4>ğŸ“ˆ ê°€ê²© ì •ë³´</h4>
      <div class="dr"><span class="dl">í˜„ì¬ê°€</span><span class="dv">$${FN(s.price)}</span></div>
      <div class="dr"><span class="dl">ì¼ê°„ ë³€ë™</span><span class="dv ${s.change_pct>=0?'pos':'neg'}">${s.change_pct>=0?'+':''}${s.change_pct}%</span></div>
      <div class="dr"><span class="dl">52ì£¼ ìµœê³ </span><span class="dv">$${FN(s.high_52w)}</span></div>
      <div class="dr"><span class="dl">52ì£¼ ìµœì €</span><span class="dv">$${FN(s.low_52w)}</span></div>
      <div class="dr"><span class="dl">ê³ ì  ëŒ€ë¹„</span><span class="dv neg">${s.pct_from_high}%</span></div>
    </div>
    <div class="dc"><h4>ğŸ”§ ê¸°ìˆ ì  ì§€í‘œ</h4>
      <div class="dr"><span class="dl">SMA 50/200</span><span class="dv">$${FN(ind.sma_50)} / $${FN(ind.sma_200)}</span></div>
      <div class="dr"><span class="dl">RSI (14)</span><span class="dv" style="color:${ind.rsi>70?'var(--r)':ind.rsi<30?'var(--g)':'var(--t1)'}">${ind.rsi}</span></div>
      <div class="dr"><span class="dl">ADX</span><span class="dv" style="color:${ind.adx>25?'var(--g)':'var(--t3)'}">${ind.adx}${ind.adx>40?' ğŸ”¥':ind.adx>25?' âœ“':''}</span></div>
      <div class="dr"><span class="dl">Supertrend</span><span class="dv" style="color:${ind.supertrend_dir==='UP'?'var(--g)':'var(--r)'}">${ind.supertrend_dir==='UP'?'â–² ìƒìŠ¹':'â–¼ í•˜ë½'}</span></div>
      <div class="dr"><span class="dl">ATR</span><span class="dv">$${FN(ind.atr)}</span></div>
    </div>
    <div class="dc"><h4>ğŸ’° ìµì ˆ ì‹ í˜¸</h4>
      <div class="dr"><span class="dl">ì§„ì…ê°€ (${pt.entry_date})</span><span class="dv">$${FN(pt.entry_price)}</span></div>
      <div class="dr"><span class="dl">ìˆ˜ìµë¥ </span><span class="dv ${pt.gain_since_signal>=0?'pos':'neg'}">${pt.gain_since_signal>=0?'+':''}${pt.gain_since_signal}% (${pt.days_in_trend}ì¼)</span></div>
      <div class="dr"><span class="dl">ATR ìŠ¤í†±</span><span class="dv">$${FN(pt.atr_trailing_stop)} (${pt.stop_distance_pct}%)</span></div>
      <div style="margin-top:6px;display:flex;gap:4px;flex-wrap:wrap">
        <span class="pz ${pt.reached_10?'pz-y':'pz-n'}" style="font-size:11px;padding:3px 8px">+10% $${FN(pt.profit_zone_10)} ${pt.reached_10?'âœ“':''}</span>
        <span class="pz ${pt.reached_20?'pz-y':'pz-n'}" style="font-size:11px;padding:3px 8px">+20% $${FN(pt.profit_zone_20)} ${pt.reached_20?'âœ“':''}</span>
        <span class="pz ${pt.reached_30?'pz-y':'pz-n'}" style="font-size:11px;padding:3px 8px">+30% $${FN(pt.profit_zone_30)} ${pt.reached_30?'âœ“':''}</span>
      </div>
    </div>
    <div class="dc"><h4>ğŸš¨ EXIT ê²½ê³ </h4>
      <div class="dr"><span class="dl">EMA-10 ì´íƒˆ</span><span class="dv" style="color:${pt.ema10_exit_warning?'var(--r)':'var(--g)'}">${pt.ema10_exit_warning?'âš  ê²½ê³ ':'âœ“ ì•ˆì „'}</span></div>
      <div class="dr"><span class="dl">ì ìˆ˜ í•˜ë½ (&lt;40)</span><span class="dv" style="color:${pt.score_drop_warning?'var(--r)':'var(--g)'}">${pt.score_drop_warning?'âš  ê²½ê³ ':'âœ“ ì•ˆì „'}</span></div>
      <div style="margin-top:8px;padding:8px;background:var(--bg1);border-radius:6px;font-size:11px;color:var(--t2)">
        ${s.trend_score>=60?'âœ… íŠ¸ë Œë“œ ìœ ì§€ â€” ë³´ìœ  ì§€ì†':s.trend_score>=40?'âš ï¸ íŠ¸ë Œë“œ ì•½í™” â€” ë¶€ë¶„ ìµì ˆ ê³ ë ¤':'ğŸ”´ íŠ¸ë Œë“œ ì´íƒˆ â€” ë§¤ë„ ì¶”ì²œ'}
      </div>
    </div>
  </div>`;

  // Backtest stats
  html+=`<div class="bt-sec"><h4>ğŸ“Š ë°±í…ŒìŠ¤íŠ¸ ê²°ê³¼ (1ë…„) ${hasTM?`Â· ${bt.trade_markers.filter(m=>m.type==='BUY').length}íšŒ ì§„ì…`:''}</h4>
    <div class="bt-g">
      <div class="bt-s"><div class="bv" style="color:${bt.win_rate>=50?'var(--g)':'var(--r)'}">${bt.win_rate}%</div><div class="bl">ìŠ¹ë¥ </div></div>
      <div class="bt-s"><div class="bv">${bt.total_trades}</div><div class="bl">ì´ ê±°ë˜</div></div>
      <div class="bt-s"><div class="bv pos">+${bt.avg_winner}%</div><div class="bl">í‰ê·  ìˆ˜ìµ</div></div>
      <div class="bt-s"><div class="bv neg">${bt.avg_loser}%</div><div class="bl">í‰ê·  ì†ì‹¤</div></div>
      <div class="bt-s"><div class="bv" style="color:${bt.total_return>=0?'var(--g)':'var(--r)'}">${bt.total_return>=0?'+':''}${bt.total_return}%</div><div class="bl">ì „ëµ ìˆ˜ìµ</div></div>
      <div class="bt-s"><div class="bv" style="color:${bt.buy_hold_return>=0?'var(--g)':'var(--r)'}">${bt.buy_hold_return>=0?'+':''}${bt.buy_hold_return}%</div><div class="bl">ë‹¨ìˆœ ë³´ìœ </div></div>
      <div class="bt-s"><div class="bv neg">${bt.max_drawdown}%</div><div class="bl">ìµœëŒ€ ë‚™í­</div></div>
      <div class="bt-s"><div class="bv" style="color:${(bt.total_return-bt.buy_hold_return)>=0?'var(--g)':'var(--r)'}">${(bt.total_return-bt.buy_hold_return)>=0?'+':''}${(bt.total_return-bt.buy_hold_return).toFixed(1)}%</div><div class="bl">ì´ˆê³¼ ìˆ˜ìµ</div></div>
    </div>
  </div>`;

  document.getElementById('dp').innerHTML=html;
  document.getElementById('ol').classList.add('show');
  document.body.style.overflow='hidden';

  // Render charts after DOM update
  setTimeout(()=>{
    if(hasPH)renderPriceChart(s);
    if(hasEC)renderEqChart(s);
  },100);
}

function renderPriceChart(s){
  const ph=s.price_history;if(!ph)return;
  const ctx=document.getElementById('priceCanvas');if(!ctx)return;
  const labels=ph.map(p=>p.d.slice(5));
  const tm=s.backtest.trade_markers||[];

  // Build background colors for supertrend zones
  const bgColors=ph.map(p=>p.st===1?'rgba(34,197,94,.06)':'rgba(239,68,68,.06)');

  // Find buy/sell points mapped to chart indices
  const buyPts=new Array(ph.length).fill(null);
  const sellPts=new Array(ph.length).fill(null);
  tm.forEach(m=>{
    const idx=ph.findIndex(p=>p.d===m.date);
    if(idx>=0){
      if(m.type==='BUY')buyPts[idx]=ph[idx].c;
      else sellPts[idx]=ph[idx].c;
    }
  });

  if(priceChartInstance)priceChartInstance.destroy();
  priceChartInstance=new Chart(ctx,{type:'line',data:{labels,datasets:[
    {label:'ì¢…ê°€',data:ph.map(p=>p.c),borderColor:'#e2e8f0',backgroundColor:'rgba(226,232,240,.05)',fill:true,tension:.2,pointRadius:0,borderWidth:2},
    {label:'SMA 50',data:ph.map(p=>p.s50),borderColor:'#3b82f6',borderDash:[4,4],tension:.3,pointRadius:0,borderWidth:1.5},
    {label:'SMA 200',data:ph.map(p=>p.s200),borderColor:'#eab308',borderDash:[4,4],tension:.3,pointRadius:0,borderWidth:1.5},
    {label:'â–² ë§¤ìˆ˜',data:buyPts,borderColor:'#22c55e',backgroundColor:'#22c55e',pointStyle:'triangle',pointRadius:8,pointHoverRadius:10,showLine:false},
    {label:'â–¼ ë§¤ë„',data:sellPts,borderColor:'#ef4444',backgroundColor:'#ef4444',pointStyle:'triangle',rotation:180,pointRadius:8,pointHoverRadius:10,showLine:false}
  ]},options:{responsive:true,maintainAspectRatio:false,interaction:{intersect:false,mode:'index'},plugins:{legend:{labels:{color:'#94a3b8',font:{size:9},usePointStyle:true}},tooltip:{callbacks:{label:function(c){
    if(c.dataset.label==='â–² ë§¤ìˆ˜'&&c.raw!==null)return`ë§¤ìˆ˜ ì§„ì…: $${c.raw}`;
    if(c.dataset.label==='â–¼ ë§¤ë„'&&c.raw!==null)return`ë§¤ë„ í‡´ì¶œ: $${c.raw}`;
    return`${c.dataset.label}: $${c.raw}`;
  }}}},scales:{x:{ticks:{color:'#64748b',font:{size:9},maxTicksLimit:10},grid:{display:false}},y:{ticks:{color:'#64748b',font:{size:9}},grid:{color:'rgba(30,45,69,.5)'}}}}});
}

function renderEqChart(s){
  const ec=s.backtest.equity_curve;if(!ec||!ec.length)return;
  const ctx=document.getElementById('eqCanvas');if(!ctx)return;
  const labels=ec.map(e=>e.d.slice(5));
  const tm=s.backtest.trade_markers||[];

  // Map markers to equity curve indices
  const buyPts=new Array(ec.length).fill(null);
  const sellPts=new Array(ec.length).fill(null);
  tm.forEach(m=>{
    const idx=ec.findIndex(e=>e.d===m.date);
    if(idx>=0){
      if(m.type==='BUY')buyPts[idx]=ec[idx].s;
      else sellPts[idx]=ec[idx].s;
    }
  });

  if(eqChartInstance)eqChartInstance.destroy();
  eqChartInstance=new Chart(ctx,{type:'line',data:{labels,datasets:[
    {label:'ì „ëµ',data:ec.map(e=>e.s),borderColor:'#3b82f6',backgroundColor:'rgba(59,130,246,.1)',fill:true,tension:.3,pointRadius:0,borderWidth:2},
    {label:'ë‹¨ìˆœë³´ìœ ',data:ec.map(e=>e.b),borderColor:'#94a3b8',borderDash:[4,4],tension:.3,pointRadius:0,borderWidth:1.5},
    {label:'â–² ë§¤ìˆ˜',data:buyPts,borderColor:'#22c55e',backgroundColor:'#22c55e',pointStyle:'triangle',pointRadius:7,showLine:false},
    {label:'â–¼ ë§¤ë„',data:sellPts,borderColor:'#ef4444',backgroundColor:'#ef4444',pointStyle:'triangle',rotation:180,pointRadius:7,showLine:false}
  ]},options:{responsive:true,maintainAspectRatio:false,interaction:{intersect:false,mode:'index'},plugins:{legend:{labels:{color:'#94a3b8',font:{size:9},usePointStyle:true}},tooltip:{callbacks:{label:function(c){
    if(c.dataset.label==='â–² ë§¤ìˆ˜')return c.raw?`ë§¤ìˆ˜ ì§„ì… (${c.raw})`:null;
    if(c.dataset.label==='â–¼ ë§¤ë„')return c.raw?`ë§¤ë„ í‡´ì¶œ (${c.raw})`:null;
    return`${c.dataset.label}: ${c.raw}`;
  }}}},scales:{x:{ticks:{color:'#64748b',font:{size:9},maxTicksLimit:10},grid:{display:false}},y:{ticks:{color:'#64748b',font:{size:9}},grid:{color:'rgba(30,45,69,.5)'}}}}});
}

function closeD(){document.getElementById('ol').classList.remove('show');document.body.style.overflow='';
  if(priceChartInstance){priceChartInstance.destroy();priceChartInstance=null}
  if(eqChartInstance){eqChartInstance.destroy();eqChartInstance=null}}

// â”€â”€ Events â”€â”€
document.getElementById('si').addEventListener('input',e=>{sq=e.target.value;renderTbl()});
document.getElementById('sf').addEventListener('click',e=>{if(e.target.classList.contains('fb')){
  document.querySelectorAll('.fb').forEach(b=>b.classList.remove('on'));e.target.classList.add('on');cf=e.target.dataset.f;renderTbl()}});
document.getElementById('ss').addEventListener('change',e=>{cs=e.target.value;renderTbl()});
document.getElementById('ol').addEventListener('click',e=>{if(e.target===document.getElementById('ol'))closeD()});
document.addEventListener('keydown',e=>{if(e.key==='Escape')closeD()});
document.getElementById('histTabs').addEventListener('click',e=>{if(e.target.classList.contains('chart-tab')){
  document.querySelectorAll('.chart-tab').forEach(t=>t.classList.remove('active'));e.target.classList.add('active');renderHistChart(e.target.dataset.chart)}});

function render(){
  document.getElementById('ut').textContent=`ì—…ë°ì´íŠ¸: ${D.updated}`;
  renderOv();renderSec();renderTbl();renderHistChart('score');
}
init();
</script>
</body>
</html>
